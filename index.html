<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>New Customer Intake Form</title>
    <style>
        body {
            background-color: black;
            display: flex;
            justify-content: center;
            align-items: center;
            min-height: 100vh;
            margin: 0;
            font-family: Arial, sans-serif;
        }
        form {
            background-color: #333;
            padding: 20px;
            margin: 50px;
            max-width: 1000px;
            width: 100%;
            text-align: center;
            box-sizing: border-box;
            color: white;
        }
        .row {
            display: flex;
            gap: 10px;
            margin-bottom: 10px;
            justify-content: center;
            flex-wrap: wrap;
        }
        .row input {
            flex: 1;
            min-width: 150px;
            max-width: 250px;
            padding: 5px;
            color: white;
            background-color: #444;
            border: 1px solid #666;
        }
        .row input::placeholder {
            color: #ccc;
            opacity: 1;
        }
        #customer_name {
            max-width: 400px;
            width: 100%;
            color: white;
            background-color: #444;
            border: 1px solid #666;
        }
        #customer_name::placeholder {
            color: #ccc;
            opacity: 1;
        }
        #notes {
            max-width: 500px;
            width: 100%;
            height: 100px;
            color: white;
            background-color: #444;
            border: 1px solid #666;
        }
        #notes::placeholder {
            color: #ccc;
            opacity: 1;
        }
        #dist_location {
            color: white;
            background-color: #444;
            border: 1px solid #666;
        }
        #dist_location::placeholder {
            color: #ccc;
            opacity: 1;
        }
        input[name^="delivery_hours"] {
            color: white;
            background-color: #444;
            border: 1px solid #666;
            width: 250px;
        }
        input[name^="delivery_hours"]::placeholder {
            color: #ccc;
            opacity: 1;
        }
        input[name="other_pricing"] {
            color: white;
            background-color: #444;
            border: 1px solid #666;
            max-width: 250px;
        }
        input[name="other_pricing"]::placeholder {
            color: #ccc;
            opacity: 1;
        }
        #text-signature {
            width: 100%;
            max-width: 280px;
            margin-top: 5px;
            color: white;
            background-color: #444;
            border: 1px solid #666;
        }
        #text-signature::placeholder {
            color: #ccc;
            opacity: 1;
        }
        div {
            margin-bottom: 15px;
        }
        label, input, select, textarea {
            display: inline-block;
            text-align: center;
            color: white;
        }
        select {
            background-color: #444;
            border: 1px solid #666;
        }
        button {
            margin: 15px auto;
            padding: 10px 20px;
            background-color: #444;
            border: 1px solid #666;
            border-radius: 5px;
            cursor: pointer;
            color: white;
            z-index: 1001;
        }
        button:hover {
            background-color: #555;
        }
        #locations {
            text-align: center;
        }
        .location {
            margin-bottom: 20px;
        }
        #gpo_options, #dist_options, #other_pricing {
            text-align: center;
        }
        #signature-pad {
            border: 2px solid #666;
            background-color: #222;
            width: 90%;
            max-width: 400px;
            height: 150px;
            display: block;
            visibility: visible;
            touch-action: none;
            z-index: 1001;
        }
        #mobile-signature-pad {
            border: 2px solid #666;
            background-color: #222;
            width: 100%;
            max-width: 400px;
            height: 150px;
            display: none;
            visibility: visible;
            touch-action: none;
            z-index: 1001;
        }
        #signature-section {
            margin-top: 20px;
            position: relative;
        }
        .signature-container {
            display: flex;
            flex-direction: column;
            align-items: center;
        }
        .radio-group {
            display: flex;
            align-items: center;
            justify-content: center;
            gap: 10px;
            flex-wrap: nowrap;
        }
        .radio-buttons {
            display: flex;
            gap: 5px;
            margin-left: 10px;
            align-items: center;
        }
        .radio-buttons input {
            margin-right: 5px;
        }
        .dropdown-group {
            display: flex;
            align-items: center;
            justify-content: center;
            gap: 10px;
        }
        .dropdown-field {
            display: flex;
            gap: 5px;
            margin-left: 10px;
        }
        .w9-message {
            font-weight: bold;
            color: #00FFFF;
            margin-top: 5px;
            font-size: 16px;
            font-style: italic;
        }
        .tax-exempt-message, .payment-terms-message {
            color: #00FFFF;
        }
        .logo-container {
            margin-bottom: 10px;
            text-align: center;
            padding: 10px;
        }
        .logo-container img {
            width: 150px;
            height: auto;
            display: block;
            margin: 0 auto;
        }
        #multi_location_message {
            color: green;
        }
        .accounts-payable {
            display: block;
        }
        .accounts-payable.hidden {
            display: none;
        }
        .signature-feedback, .form-error {
            color: #ff5555;
            font-size: 14px;
            margin-top: 5px;
            display: block;
        }
        .form-success {
            color: #00ff00;
            font-size: 14px;
            margin-top: 5px;
            display: block;
        }
        @media (max-width: 600px) {
            form {
                margin: 20px;
                padding: 15px;
            }
            .row input {
                min-width: 100px;
                max-width: 200px;
            }
            #signature-pad {
                display: none;
            }
            #mobile-signature-pad {
                display: block;
            }
            #customer_name {
                max-width: 300px;
            }
            #notes {
                max-width: 300px;
            }
            input[name^="delivery_hours"] {
                width: 200px;
            }
            button {
                padding: 8px 16px;
                font-size: 14px;
            }
        }
    </style>
    <script>
        function updateAccountsPayableVisibility() {
            const multiLocationYes = document.getElementById('multi_location_yes')?.checked || false;
            const rgSetupYes = document.getElementById('rg_setup_yes')?.checked || false;
            const billingCentralized = document.getElementById('billing_centralized')?.checked || false;
            const apSections = document.querySelectorAll('.accounts-payable');
            if (multiLocationYes && rgSetupYes && billingCentralized) {
                apSections.forEach(section => section.classList.add('hidden'));
            } else {
                apSections.forEach(section => section.classList.remove('hidden'));
            }
        }
        function addLocation() {
            var locations = document.getElementById('locations');
            var count = locations.getElementsByClassName('location').length;
            var singleBillingYes = document.getElementById('single_billing_yes')?.checked || false;
            var newLoc;
            if (singleBillingYes) {
                newLoc = document.createElement('div');
                newLoc.className = 'location';
                newLoc.innerHTML = `
                    <h2>Location ${count + 1} Information</h2>
                    <div>
                        <label>Purchasing Contact:</label>
                        <div class="row">
                            <input type="text" name="purchasing_first[]" placeholder="First Name" aria-label="Purchasing Contact First Name">
                            <input type="text" name="purchasing_last[]" placeholder="Last Name" aria-label="Purchasing Contact Last Name">
                        </div>
                        <div class="row">
                            <input type="email" name="purchasing_email[]" placeholder="Email" pattern="[a-z0-9._%+-]+@[a-z0-9.-]+\\.[a-z]{2,}$" aria-label="Purchasing Contact Email">
                            <input type="tel" name="purchasing_phone[]" placeholder="Phone Number" pattern="[0-9]{10,}" aria-label="Purchasing Contact Phone">
                        </div>
                    </div>
                    <div>
                        <label>Ship to Address:</label>
                        <div class="row">
                            <input type="text" name="ship_street[]" placeholder="Street" aria-label="Shipping Street">
                            <input type="text" name="ship_city[]" placeholder="City" aria-label="Shipping City">
                            <input type="text" name="ship_state[]" placeholder="State" aria-label="Shipping State">
                            <input type="text" name="ship_zip[]" placeholder="Zip Code" pattern="[0-9]{5}(-[0-9]{4})?" aria-label="Shipping Zip Code">
                        </div>
                    </div>
                    <div>
                        <label>Warehouse and/or Receiving Contact:</label>
                        <div class="row">
                            <input type="text" name="warehouse_first[]" placeholder="First Name" aria-label="Warehouse Contact First Name">
                            <input type="text" name="warehouse_last[]" placeholder="Last Name" aria-label="Warehouse Contact Last Name">
                        </div>
                        <div class="row">
                            <input type="email" name="warehouse_email[]" placeholder="Email" pattern="[a-z0-9._%+-]+@[a-z0-9.-]+\\.[a-z]{2,}$" aria-label="Warehouse Contact Email">
                            <input type="tel" name="warehouse_phone[]" placeholder="Phone Number" pattern="[0-9]{10,}" aria-label="Warehouse Contact Phone">
                        </div>
                    </div>
                    <div class="dropdown-group">
                        <label for="delivery_hours_${count}">Dock Availability:</label>
                        <div class="dropdown-field">
                            <input type="text" id="delivery_hours_${count}" name="delivery_hours[]" placeholder="Hours & Days" aria-label="Dock Availability">
                        </div>
                    </div>
                    <div class="radio-group">
                        <label>Liftgate Required?</label>
                        <div class="radio-buttons">
                            <input type="radio" id="liftgate_yes_${count}" name="liftgate[${count}]" value="yes">
                            <label for="liftgate_yes_${count}">Yes</label>
                            <input type="radio" id="liftgate_no_${count}" name="liftgate[${count}]" value="no">
                            <label for="liftgate_no_${count}">No</label>
                        </div>
                    </div>
                    <div class="radio-group">
                        <label>Delivery Appointment Required?</label>
                        <div class="radio-buttons">
                            <input type="radio" id="appt_yes_${count}" name="appt[${count}]" value="yes">
                            <label for="appt_yes_${count}">Yes</label>
                            <input type="radio" id="appt_no_${count}" name="appt[${count}]" value="no">
                            <label for="appt_no_${count}">No</label>
                        </div>
                    </div>
                `;
            } else {
                newLoc = locations.getElementsByClassName('location')[0].cloneNode(true);
                newLoc.querySelector('h2').textContent = 'Location ' + (count + 1) + ' Information';
                var inputs = newLoc.querySelectorAll('input');
                for (var i = 0; i < inputs.length; i++) {
                    if (inputs[i].name) {
                        inputs[i].name = inputs[i].name.replace(/\[\d+\]/, '[]');
                        inputs[i].value = '';
                        if (inputs[i].type === 'radio') {
                            inputs[i].checked = false;
                            inputs[i].name = inputs[i].name.replace(/\[\d+\]/, `[${count}]`);
                            inputs[i].id = inputs[i].id.replace(/\[\d+\]/, `_${count}`);
                        }
                        if (inputs[i].name.startsWith('delivery_hours')) {
                            inputs[i].id = `delivery_hours_${count}`;
                            inputs[i].setAttribute('aria-label', 'Dock Availability');
                            inputs[i].placeholder = 'Hours & Days';
                        }
                    }
                }
                var label = newLoc.querySelector('label[for^="delivery_hours"]');
                if (label) {
                    label.textContent = 'Dock Availability:';
                    label.setAttribute('for', `delivery_hours_${count}`);
                }
            }
            var removeBtn = document.createElement('button');
            removeBtn.type = 'button';
            removeBtn.textContent = 'Remove Location';
            removeBtn.onclick = function() { removeLocation(this); };
            newLoc.appendChild(removeBtn);
            locations.appendChild(newLoc);
            updateAccountsPayableVisibility();
        }
        function removeLocation(button) {
            var locations = document.getElementById('locations');
            if (locations.getElementsByClassName('location').length > 1) {
                button.parentElement.remove();
                updateLocationHeaders();
                updateAccountsPayableVisibility();
            }
        }
        function updateLocationHeaders() {
            var locations = document.getElementById('locations').getElementsByClassName('location');
            for (var i = 0; i < locations.length; i++) {
                locations[i].querySelector('h2').textContent = (i === 0 ? 'Primary' : (i + 1)) + ' Information';
                var inputs = locations[i].querySelectorAll('input');
                for (var j = 0; j < inputs.length; j++) {
                    if (inputs[j].type === 'radio') {
                        inputs[j].name = inputs[j].name.replace(/\[\d+\]/, `[${i}]`);
                        inputs[j].id = inputs[j].id.replace(/_\d+/, `_${i}`);
                    }
                    if (inputs[j].name.startsWith('delivery_hours')) {
                        inputs[j].id = `delivery_hours_${i}`;
                        inputs[j].setAttribute('aria-label', 'Dock Availability');
                        inputs[j].placeholder = 'Hours & Days';
                    }
                }
                var label = locations[i].querySelector('label[for^="delivery_hours"]');
                if (label) {
                    label.setAttribute('for', `delivery_hours_${i}`);
                    label.textContent = 'Dock Availability:';
                }
            }
            updateAccountsPayableVisibility();
        }
        function showGpoOptions() {
            document.getElementById('gpo_options').style.display = 'block';
        }
        function hideGpoOptions() {
            document.getElementById('gpo_options').style.display = 'none';
        }
        function showDistOptions() {
            document.getElementById('dist_options').style.display = 'block';
        }
        function hideDistOptions() {
            document.getElementById('dist_options').style.display = 'none';
        }
        function checkOther(select) {
            if (select.value === 'other') {
                document.getElementById('other_pricing').style.display = 'block';
            } else {
                document.getElementById('other_pricing').style.display = 'none';
            }
        }
        function showNetworkSetup() {
            document.getElementById('network_setup').style.display = 'block';
            document.getElementById('multi_location_message').style.display = 'block';
            updateSingleBillingVisibility();
            updateW9Display();
        }
        function hideNetworkSetup() {
            document.getElementById('network_setup').style.display = 'none';
            document.getElementById('multi_location_message').style.display = 'none';
            hideBillingType();
            updateSingleBillingVisibility();
            updateW9Display();
        }
        function showBillingType() {
            document.getElementById('billing_type').style.display = 'block';
            updateSingleBillingVisibility();
            updateW9Display();
        }
        function hideBillingType() {
            document.getElementById('billing_type').style.display = 'none';
            hideBillingMessages();
            updateSingleBillingVisibility();
            updateW9Display();
        }
        function showLocalizedMessage() {
            document.getElementById('localized_message').style.display = 'block';
            document.getElementById('centralized_message').style.display = 'none';
            updateW9Display();
        }
        function showCentralizedMessage() {
            document.getElementById('centralized_message').style.display = 'block';
            document.getElementById('localized_message').style.display = 'none';
            updateW9Display();
        }
        function hideBillingMessages() {
            document.getElementById('localized_message').style.display = 'none';
            document.getElementById('centralized_message').style.display = 'none';
            updateW9Display();
        }
        function updateSingleBillingVisibility() {
            const multiLocationYes = document.getElementById('multi_location_yes').checked;
            const rgSetupNo = document.getElementById('rg_setup_no')?.checked || false;
            const singleBillingDiv = document.getElementById('single_billing');
            if (singleBillingDiv) {
                singleBillingDiv.style.display = multiLocationYes && rgSetupNo ? 'flex' : 'none';
            }
            const singleBillingMessage = document.getElementById('single_billing_message');
            if (singleBillingMessage) singleBillingMessage.style.display = 'none';
            updateAccountsPayableVisibility();
        }
        function showSingleBillingMessage() {
            const singleBillingMessage = document.getElementById('single_billing_message');
            if (singleBillingMessage) {
                singleBillingMessage.style.display = document.getElementById('single_billing_no').checked ? 'block' : 'none';
            }
            updateAccountsPayableVisibility();
        }
        function updateW9Display() {
            const w9Message = document.querySelector('.w9-message');
            if (!w9Message) return;
            const multiLocationYes = document.getElementById('multi_location_yes').checked;
            const multiLocationNo = document.getElementById('multi_location_no').checked;
            const rgSetupYes = document.getElementById('rg_setup_yes')?.checked || false;
            const rgSetupNo = document.getElementById('rg_setup_no')?.checked || false;
            const billingLocalized = document.getElementById('billing_localized')?.checked || false;
            if ((multiLocationYes && rgSetupNo) || multiLocationNo || (multiLocationYes && rgSetupYes && billingLocalized)) {
                w9Message.style.display = 'block';
            } else {
                w9Message.style.display = 'none';
            }
        }

        function saveSignature() {
            console.log('Saving signature');
            const isMobile = /Mobi|Android|iPhone|iPad|iPod/i.test(navigator.userAgent);
            const signaturePad = document.getElementById('signature-pad');
            const mobileSignaturePad = document.getElementById('mobile-signature-pad');
            const textSignature = document.getElementById('text-signature');
            const signatureDataInput = document.getElementById('signature-data');
            const signatureSection = document.getElementById('signature-section');
            let signatureData = '';

            try {
                if (textSignature && textSignature.value.trim()) {
                    signatureData = textSignature.value;
                    console.log('Text signature saved:', signatureData);
                } else {
                    signatureData = isMobile ? mobileSignaturePad.toDataURL('image/jpeg', 0.5) : signaturePad.toDataURL('image/jpeg', 0.5);
                    console.log('Canvas signature saved:', signatureData.substring(0, 50) + '...', 'Size:', signatureData.length);
                }
                if (!signatureData || signatureData === 'data:,') {
                    const errorMsg = document.createElement('span');
                    errorMsg.className = 'form-error signature-feedback';
                    errorMsg.textContent = 'No signature provided. Please draw or type a signature.';
                    errorMsg.setAttribute('role', 'alert');
                    if (!signatureSection.querySelector('.signature-feedback')) {
                        signatureSection.appendChild(errorMsg);
                        setTimeout(() => errorMsg.remove(), 3000);
                    }
                    console.log('Save signature failed: No signature provided');
                    return;
                }
                signatureDataInput.value = signatureData;
                localStorage.setItem('signatureData', signatureData);
                const feedback = document.createElement('span');
                feedback.className = 'form-success signature-feedback';
                feedback.textContent = 'Signature saved!';
                feedback.setAttribute('role', 'status');
                if (!signatureSection.querySelector('.signature-feedback')) {
                    signatureSection.appendChild(feedback);
                    setTimeout(() => feedback.remove(), 2000);
                }
            } catch (error) {
                console.error('Error saving signature:', error);
                const errorMsg = document.createElement('span');
                errorMsg.className = 'form-error signature-feedback';
                errorMsg.textContent = 'Error saving signature. Please try again.';
                errorMsg.setAttribute('role', 'alert');
                if (!signatureSection.querySelector('.signature-feedback')) {
                    signatureSection.appendChild(errorMsg);
                    setTimeout(() => errorMsg.remove(), 3000);
                }
            }
        }

        function validateForm() {
            console.log('Validating form');
            const form = document.querySelector('form');
            const inputs = form.querySelectorAll('input[required], select[required]');
            const isMobile = /Mobi|Android|iPhone|iPad|iPod/i.test(navigator.userAgent);
            const signaturePad = document.getElementById('signature-pad');
            const mobileSignaturePad = document.getElementById('mobile-signature-pad');
            const textSignature = document.getElementById('text-signature');
            const signatureDataInput = document.getElementById('signature-data');
            const signatureSection = document.getElementById('signature-section');
            let isValid = true;

            document.querySelectorAll('.form-error').forEach(el => el.remove());

            inputs.forEach(input => {
                if (!input.value.trim()) {
                    isValid = false;
                    input.classList.add('error');
                    input.setAttribute('aria-invalid', 'true');
                    const errorMsg = document.createElement('span');
                    errorMsg.className = 'form-error';
                    errorMsg.textContent = `${input.getAttribute('aria-label')} is required.`;
                    input.parentNode.appendChild(errorMsg);
                    console.log(`Validation failed: ${input.getAttribute('aria-label')} is empty`);
                } else {
                    input.classList.remove('error');
                    input.setAttribute('aria-invalid', 'false');
                }
            });

            let signatureData = signatureDataInput.value;
            if (!signatureData) {
                signatureData = textSignature && textSignature.value.trim() ? textSignature.value : (isMobile ? mobileSignaturePad.toDataURL('image/jpeg', 0.5) : signaturePad.toDataURL('image/jpeg', 0.5));
                signatureDataInput.value = signatureData;
                console.log('Validate signature:', signatureData.substring(0, 50) + '...', 'Size:', signatureData.length);
            }
            if (!signatureData || signatureData === 'data:,') {
                isValid = false;
                const signatureError = document.createElement('span');
                signatureError.className = 'form-error signature-feedback';
                signatureError.textContent = 'Please provide a signature by drawing or typing.';
                signatureError.setAttribute('role', 'alert');
                if (!signatureSection.querySelector('.signature-feedback')) {
                    signatureSection.appendChild(signatureError);
                    setTimeout(() => signatureError.remove(), 3000);
                }
                console.log('Validation failed: No signature provided');
            } else {
                console.log('Signature validated:', signatureData.substring(0, 50) + '...', 'Size:', signatureData.length);
            }

            console.log('Validation result:', isValid);
            return isValid;
        }

        window.onload = function() {
            console.log('Window loaded');
            const isMobile = /Mobi|Android|iPhone|iPad|iPod/i.test(navigator.userAgent);
            const signatureSection = document.getElementById('signature-section');
            const signaturePad = document.getElementById('signature-pad');
            const mobileSignaturePad = document.getElementById('mobile-signature-pad');
            const signatureInstructions = document.getElementById('signature-instructions');
            const mobileSignatureInstructions = document.getElementById('mobile-signature-instructions');
            const ctx = signaturePad.getContext('2d');
            ctx.strokeStyle = '#ffffff';
            ctx.lineWidth = 2;
            let mobileCtx = mobileSignaturePad ? mobileSignaturePad.getContext('2d') : null;
            let isDrawing = false;
            let lastX = 0;
            let lastY = 0;

            if (isMobile) {
                signaturePad.style.display = 'none';
                mobileSignaturePad.style.display = 'block';
                signatureInstructions.style.display = 'none';
                mobileSignatureInstructions.style.display = 'block';
            } else {
                signaturePad.style.display = 'block';
                mobileSignaturePad.style.display = 'none';
                signatureInstructions.style.display = 'block';
                mobileSignatureInstructions.style.display = 'none';
            }

            function debounce(fn, wait) {
                let timeout;
                return function (...args) {
                    clearTimeout(timeout);
                    timeout = setTimeout(() => fn(...args), wait);
                };
            }

            function resizeCanvas() {
                const rect = signaturePad.getBoundingClientRect();
                const dpr = window.devicePixelRatio || 1;
                const width = Math.max(rect.width, 100);
                const height = Math.max(rect.height, 50);
                signaturePad.setAttribute('width', width * dpr);
                signaturePad.setAttribute('height', height * dpr);
                ctx.scale(dpr, dpr);
                ctx.strokeStyle = '#ffffff';
                ctx.lineWidth = 2;
                signaturePad.style.width = width + 'px';
                signaturePad.style.height = height + 'px';
                console.log('Desktop canvas resized:', { width, height });
            }

            function resizeMobileCanvas() {
                if (!mobileSignaturePad || !mobileCtx) return;
                const rect = mobileSignaturePad.getBoundingClientRect();
                const dpr = window.devicePixelRatio || 1;
                const width = Math.max(rect.width, 100);
                const height = Math.max(rect.height, 50);
                mobileSignaturePad.setAttribute('width', width * dpr);
                mobileSignaturePad.setAttribute('height', height * dpr);
                mobileCtx.scale(dpr, dpr);
                mobileCtx.strokeStyle = '#ffffff';
                mobileCtx.lineWidth = 2;
                mobileSignaturePad.style.width = width + 'px';
                mobileSignaturePad.style.height = height + 'px';
                console.log('Mobile canvas resized:', { width, height });
            }

            if (!isMobile) {
                window.addEventListener('resize', debounce(resizeCanvas, 100));
                resizeCanvas();

                signaturePad.setAttribute('tabindex', '0');
                signaturePad.setAttribute('aria-label', 'Draw your signature here');
                signaturePad.setAttribute('role', 'application');
                signaturePad.setAttribute('aria-describedby', 'signature-instructions');
                signaturePad.addEventListener('keydown', { handleEvent: (e) => {
                    if (e.key === 'Enter' || e.key === ' ') {
                        const feedback = document.createElement('span');
                        feedback.className = 'signature-feedback';
                        feedback.textContent = 'Please use a mouse to draw your signature.';
                        feedback.style.color = '#ff5555';
                        feedback.setAttribute('role', 'alert');
                        if (!signatureSection.querySelector('.signature-feedback')) {
                            signatureSection.appendChild(feedback);
                            setTimeout(() => feedback.remove(), 3000);
                        }
                    }
                }, passive: false });

                signaturePad.addEventListener('mousedown', { handleEvent: (e) => {
                    e.preventDefault();
                    isDrawing = true;
                    const rect = signaturePad.getBoundingClientRect();
                    lastX = e.clientX - rect.left;
                    lastY = e.clientY - rect.top;
                    console.log('Desktop mousedown:', { x: lastX, y: lastY });
                    ctx.beginPath();
                    ctx.arc(lastX, lastY, 1, 0, 2 * Math.PI);
                    ctx.fillStyle = '#ff0000';
                    ctx.fill();
                    ctx.fillStyle = '#ffffff';
                }, passive: false });
                signaturePad.addEventListener('mousemove', { handleEvent: (e) => {
                    if (isDrawing) {
                        const rect = signaturePad.getBoundingClientRect();
                        const x = e.clientX - rect.left;
                        const y = e.clientY - rect.top;
                        ctx.beginPath();
                        ctx.moveTo(lastX, lastY);
                        ctx.lineTo(x, y);
                        ctx.stroke();
                        lastX = x;
                        lastY = y;
                        try {
                            const signatureData = signaturePad.toDataURL('image/jpeg', 0.5);
                            document.getElementById('signature-data').value = signatureData;
                            console.log('Desktop mousemove signature:', signatureData.substring(0, 50) + '...', 'Size:', signatureData.length);
                        } catch (error) {
                            console.error('Error capturing desktop signature:', error);
                        }
                    }
                }, passive: false });
                signaturePad.addEventListener('mouseup', { handleEvent: (e) => {
                    isDrawing = false;
                    try {
                        const signatureData = signaturePad.toDataURL('image/jpeg', 0.5);
                        document.getElementById('signature-data').value = signatureData;
                        console.log('Desktop mouseup signature:', signatureData.substring(0, 50) + '...', 'Size:', signatureData.length);
                    } catch (error) {
                        console.error('Error capturing desktop signature:', error);
                    }
                }, passive: false });
                signaturePad.addEventListener('mouseout', { handleEvent: (e) => {
                    isDrawing = false;
                    console.log('Desktop mouseout');
                }, passive: false });
            }

            if (isMobile && mobileSignaturePad) {
                mobileCtx.strokeStyle = '#ffffff';
                mobileCtx.lineWidth = 2;

                window.addEventListener('resize', debounce(resizeMobileCanvas, 100));
                resizeMobileCanvas();

                mobileSignaturePad.setAttribute('tabindex', '0');
                mobileSignaturePad.setAttribute('aria-label', 'Draw your signature here');
                mobileSignaturePad.setAttribute('role', 'application');
                mobileSignaturePad.setAttribute('aria-describedby', 'mobile-signature-instructions');
                mobileSignaturePad.addEventListener('keydown', { handleEvent: (e) => {
                    if (e.key === 'Enter' || e.key === ' ') {
                        const feedback = document.createElement('span');
                        feedback.className = 'signature-feedback';
                        feedback.textContent = 'Please touch the canvas to draw your signature.';
                        feedback.style.color = '#ff5555';
                        feedback.setAttribute('role', 'alert');
                        if (!signatureSection.querySelector('.signature-feedback')) {
                            signatureSection.appendChild(feedback);
                            setTimeout(() => feedback.remove(), 3000);
                        }
                    }
                }, passive: false });

                mobileSignaturePad.addEventListener('touchstart', { handleEvent: (e) => {
                    if (e.touches.length > 1) return;
                    e.preventDefault();
                    const touch = e.touches[0];
                    const rect = mobileSignaturePad.getBoundingClientRect();
                    isDrawing = true;
                    lastX = touch.clientX - rect.left;
                    lastY = touch.clientY - rect.top;
                    console.log('Mobile touchstart:', { x: lastX, y: lastY });
                    mobileCtx.beginPath();
                    mobileCtx.arc(lastX, lastY, 1, 0, 2 * Math.PI);
                    mobileCtx.fillStyle = '#ff0000';
                    mobileCtx.fill();
                    mobileCtx.fillStyle = '#ffffff';
                }, passive: false });
                mobileSignaturePad.addEventListener('touchmove', { handleEvent: (e) => {
                    if (e.touches.length > 1 || !isDrawing) return;
                    e.preventDefault();
                    const touch = e.touches[0];
                    const rect = mobileSignaturePad.getBoundingClientRect();
                    const x = touch.clientX - rect.left;
                    const y = touch.clientY - rect.top;
                    requestAnimationFrame(() => {
                        mobileCtx.beginPath();
                        mobileCtx.moveTo(lastX, lastY);
                        mobileCtx.lineTo(x, y);
                        mobileCtx.stroke();
                        lastX = x;
                        lastY = y;
                        try {
                            const signatureData = mobileSignaturePad.toDataURL('image/jpeg', 0.5);
                            document.getElementById('signature-data').value = signatureData;
                            console.log('Mobile touchmove signature:', signatureData.substring(0, 50) + '...', 'Size:', signatureData.length);
                        } catch (error) {
                            console.error('Error capturing mobile signature:', error);
                        }
                    });
                }, passive: false });
                mobileSignaturePad.addEventListener('touchend', { handleEvent: (e) => {
                    e.preventDefault();
                    isDrawing = false;
                    try {
                        const signatureData = mobileSignaturePad.toDataURL('image/jpeg', 0.5);
                        document.getElementById('signature-data').value = signatureData;
                        console.log('Mobile touchend signature:', signatureData.substring(0, 50) + '...', 'Size:', signatureData.length);
                    } catch (error) {
                        console.error('Error capturing mobile signature:', error);
                    }
                }, passive: false });
                mobileSignaturePad.addEventListener('touchcancel', { handleEvent: (e) => {
                    e.preventDefault();
                    isDrawing = false;
                    console.log('Mobile touchcancel');
                }, passive: false });
            }

            document.getElementById('save-signature').addEventListener('click', saveSignature);
            document.getElementById('clear-signature').addEventListener('click', () => {
                console.log('Clearing signature');
                ctx.clearRect(0, 0, signaturePad.width, signaturePad.height);
                if (mobileCtx) mobileCtx.clearRect(0, 0, mobileSignaturePad.width, mobileSignaturePad.height);
                document.getElementById('signature-data').value = '';
                document.getElementById('text-signature').value = '';
                localStorage.removeItem('signatureData');
                ctx.strokeStyle = '#ffffff';
                if (mobileCtx) mobileCtx.strokeStyle = '#ffffff';
                const feedback = document.createElement('span');
                feedback.className = 'form-success signature-feedback';
                feedback.textContent = 'Signature cleared.';
                feedback.setAttribute('role', 'status');
                if (!signatureSection.querySelector('.signature-feedback')) {
                    signatureSection.appendChild(feedback);
                    setTimeout(() => feedback.remove(), 2000);
                }
                console.log('Signature cleared');
            });

            document.getElementById('submit-form').addEventListener('submit', async (e) => {
                e.preventDefault();
                console.log('Submit event triggered');
                if (!validateForm()) {
                    console.log('Form validation failed');
                    return;
                }

                console.log('Form validated, submitting to Netlify');
                const form = e.target;
                const formData = new FormData(form);
                for (let [key, value] of formData.entries()) {
                    console.log(`FormData: ${key}=${typeof value === 'string' ? value.substring(0, 50) : '[non-string]'}`);
                }

                const successMsg = document.createElement('span');
                successMsg.className = 'form-success';
                successMsg.textContent = 'Submitting form, please wait...';
                successMsg.setAttribute('role', 'status');
                form.appendChild(successMsg);

                try {
                    // Use fetch for debugging
                    const response = await fetch('/', {
                        method: 'POST',
                        body: formData,
                        headers: { 'Accept': 'application/json' }
                    });
                    console.log('Fetch response status:', response.status);
                    if (response.ok) {
                        successMsg.textContent = 'Form submitted successfully!';
                        setTimeout(() => {
                            window.location.href = '/thank-you.html';
                        }, 1000);
                    } else {
                        throw new Error(`Submission failed: ${response.status} ${response.statusText}`);
                    }
                } catch (error) {
                    console.error('Submission error:', error);
                    successMsg.remove();
                    const errorMsg = document.createElement('span');
                    errorMsg.className = 'form-error';
                    errorMsg.textContent = `Error submitting form: ${error.message}. Please try again or contact support.`;
                    errorMsg.setAttribute('role', 'alert');
                    form.appendChild(errorMsg);
                    setTimeout(() => errorMsg.remove(), 5000);
                }

                // Fallback form.submit() (commented out)
                /*
                try {
                    form.submit();
                } catch (error) {
                    console.error('Submission error:', error);
                    successMsg.remove();
                    const errorMsg = document.createElement('span');
                    errorMsg.className = 'form-error';
                    errorMsg.textContent = 'Error submitting form. Please try again or contact support.';
                    errorMsg.setAttribute('role', 'alert');
                    form.appendChild(errorMsg);
                    setTimeout(() => errorMsg.remove(), 5000);
                }
                */
            });

            document.getElementById('tax_exempt_yes').addEventListener('change', () => {
                document.getElementById('tax_exempt_message').style.display = 'block';
                updateW9Display();
            });
            document.getElementById('tax_exempt_no').addEventListener('change', () => {
                document.getElementById('tax_exempt_message').style.display = 'none';
                updateW9Display();
            });
            document.getElementById('payment_terms_yes').addEventListener('change', () => {
                document.getElementById('payment_terms_message').style.display = 'block';
                document.getElementById('payment_terms_no_message').style.display = 'none';
                updateW9Display();
            });
            document.getElementById('payment_terms_no').addEventListener('change', () => {
                document.getElementById('payment_terms_message').style.display = 'none';
                document.getElementById('payment_terms_no_message').style.display = 'block';
                updateW9Display();
            });
            document.getElementById('multi_location_yes').addEventListener('change', () => { showNetworkSetup(); updateW9Display(); });
            document.getElementById('multi_location_no').addEventListener('change', () => { hideNetworkSetup(); updateW9Display(); });
            document.getElementById('rg_setup_yes').addEventListener('change', () => {
                showBillingType();
                updateW9Display();
            });
            document.getElementById('rg_setup_no').addEventListener('change', () => {
                hideBillingType();
                updateW9Display();
            });
            document.getElementById('billing_centralized').addEventListener('change', () => {
                showCentralizedMessage();
                updateW9Display();
            });
            document.getElementById('billing_localized').addEventListener('change', () => {
                showLocalizedMessage();
                updateW9Display();
            });
            document.getElementById('single_billing_yes').addEventListener('change', () => { showSingleBillingMessage(); updateW9Display(); });
            document.getElementById('single_billing_no').addEventListener('change', () => { showSingleBillingMessage(); updateW9Display(); });
            document.getElementById('save-form').addEventListener('click', saveForm);
            document.getElementById('clear-form').addEventListener('click', clearForm);
            loadForm();
            updateAccountsPayableVisibility();
            updateW9Display();

            const savedSignature = localStorage.getItem('signatureData');
            if (savedSignature) {
                const textSignature = document.getElementById('text-signature');
                if (savedSignature.startsWith('data:image/')) {
                    const img = new Image();
                    img.src = savedSignature;
                    img.onload = () => {
                        ctx.drawImage(img, 0, 0, ctx.canvas.width, ctx.canvas.height);
                        if (mobileCtx) mobileCtx.drawImage(img, 0, 0, mobileCtx.canvas.width, mobileCtx.canvas.height);
                    };
                    console.log('Loaded saved canvas signature:', savedSignature.substring(0, 50) + '...', 'Size:', savedSignature.length);
                } else {
                    textSignature.value = savedSignature;
                    console.log('Loaded saved text signature:', savedSignature);
                }
                document.getElementById('signature-data').value = savedSignature;
            }
        };
        function saveForm() {
            console.log('Saving form');
            const form = document.querySelector('form');
            const isMobile = /Mobi|Android|iPhone|iPad|iPod/i.test(navigator.userAgent);
            const signaturePad = document.getElementById('signature-pad');
            const mobileSignaturePad = document.getElementById('mobile-signature-pad');
            const textSignature = document.getElementById('text-signature');
            const signatureDataInput = document.getElementById('signature-data');
            const formData = new FormData(form);
            const data = {};

            let signatureData = signatureDataInput.value;
            if (!signatureData) {
                signatureData = textSignature && textSignature.value.trim() ? textSignature.value : (isMobile ? mobileSignaturePad.toDataURL('image/jpeg', 0.5) : signaturePad.toDataURL('image/jpeg', 0.5));
                signatureDataInput.value = signatureData;
                console.log('Saving form signature:', signatureData.substring(0, 50) + '...', 'Size:', signatureData.length);
            }
            data['signature'] = signatureData;

            for (let [key, value] of formData.entries()) {
                if (key !== 'signature') {
                    if (!data[key]) {
                        data[key] = value;
                    } else {
                        if (!Array.isArray(data[key])) {
                            data[key] = [data[key]];
                        }
                        data[key].push(value);
                    }
                }
            }
            const locations = document.getElementById('locations').getElementsByClassName('location').length;
            data['num_locations'] = locations;

            try {
                localStorage.setItem('customerIntakeForm', JSON.stringify(data));
                console.log('Form saved to localStorage');
            } catch (error) {
                console.error('Error saving to localStorage:', error);
            }

            const feedback = document.createElement('span');
            feedback.className = 'form-success';
            feedback.textContent = 'Form saved!';
            feedback.setAttribute('role', 'status');
            form.appendChild(feedback);
            setTimeout(() => feedback.remove(), 2000);
        }
        function loadForm() {
            console.log('Loading form');
            const saved = localStorage.getItem('customerIntakeForm');
            if (!saved) return;
            const data = JSON.parse(saved);
            const numLocations = data['num_locations'] || 1;
            const singleBillingYes = data['single_billing'] === 'yes';
            for (let i = 1; i < numLocations; i++) {
                addLocation();
            }
            for (let key in data) {
                if (key === 'num_locations' || key === 'signature') continue;
                const elements = document.querySelectorAll(`[name="${key}"]`);
                let values = Array.isArray(data[key]) ? data[key] : [data[key]];
                elements.forEach((el, idx) => {
                    if (el.type === 'radio' || el.type === 'checkbox') {
                        if (el.value === values[0]) el.checked = true;
                    } else {
                        el.value = values[idx] || '';
                    }
                });
            }
            if (document.getElementById('multi_location_yes').checked) showNetworkSetup();
            if (document.getElementById('rg_setup_yes').checked) showBillingType();
            if (document.getElementById('billing_centralized').checked) showCentralizedMessage();
            if (document.getElementById('billing_localized').checked) showLocalizedMessage();
            if (document.getElementById('gpo_yes').checked) showGpoOptions();
            if (document.getElementById('distributor_yes').checked) showDistOptions();
            if (document.getElementById('pricing').value === 'other') checkOther(document.getElementById('pricing'));
            if (document.getElementById('tax_exempt_yes').checked) document.getElementById('tax_exempt_message').style.display = 'block';
            if (document.getElementById('payment_terms_yes').checked) {
                document.getElementById('payment_terms_message').style.display = 'block';
                document.getElementById('payment_terms_no_message').style.display = 'none';
            } else if (document.getElementById('payment_terms_no').checked) {
                document.getElementById('payment_terms_message').style.display = 'none';
                document.getElementById('payment_terms_no_message').style.display = 'block';
            }
            updateSingleBillingVisibility();
            showSingleBillingMessage();
            updateAccountsPayableVisibility();
            updateW9Display();
        }
        function clearForm() {
            console.log('Clearing form');
            localStorage.removeItem('customerIntakeForm');
            localStorage.removeItem('signatureData');
            document.querySelector('form').reset();
            const locations = document.getElementById('locations');
            while (locations.getElementsByClassName('location').length > 1) {
                locations.lastChild.remove();
            }
            hideGpoOptions();
            hideDistOptions();
            document.getElementById('other_pricing').style.display = 'none';
            document.getElementById('tax_exempt_message').style.display = 'none';
            document.getElementById('payment_terms_message').style.display = 'none';
            document.getElementById('payment_terms_no_message').style.display = 'none';
            hideNetworkSetup();
            document.getElementById('single_billing').style.display = 'none';
            document.getElementById('single_billing_message').style.display = 'none';
            document.getElementById('multi_location_message').style.display = 'none';
            const ctx = document.getElementById('signature-pad').getContext('2d');
            ctx.clearRect(0, 0, ctx.canvas.width, ctx.canvas.height);
            const mobileSignaturePad = document.getElementById('mobile-signature-pad');
            if (mobileSignaturePad) {
                const mobileCtx = mobileSignaturePad.getContext('2d');
                mobileCtx.clearRect(0, 0, mobileSignaturePad.width, mobileSignaturePad.height);
            }
            document.getElementById('signature-data').value = '';
            document.getElementById('text-signature').value = '';
            const feedback = document.createElement('span');
            feedback.className = 'form-success';
            feedback.textContent = 'Form cleared!';
            feedback.setAttribute('role', 'status');
            document.querySelector('form').appendChild(feedback);
            setTimeout(() => feedback.remove(), 2000);
            updateAccountsPayableVisibility();
            updateW9Display();
            console.log('Form cleared');
        }
    </script>
</head>
<body>
    <form name="customer-intake" method="POST" data-netlify="true" netlify-honeypot="bot-field" action="/thank-you.html">
        <input type="hidden" name="form-name" value="customer-intake">
        <p hidden><label>Don't fill this out: <input name="bot-field"></label></p>
        <div class="logo-container">
            <img src="your-logo-file.png" alt="Company Logo">
        </div>
        <h1>New Customer Intake Form</h1>
        <div>
            <label for="customer_name">Customer Name:</label><br>
            <input type="text" id="customer_name" name="customer_name" required aria-label="Customer Name">
            <br><br>
            <h6 class="w9-message">Please provide an up to date W-9</h6>
        </div>
        <div class="radio-group">
            <label>Are you a part of a multi-location entity?</label>
            <div class="radio-buttons">
                <input type="radio" id="multi_location_yes" name="multi_location" value="yes" onclick="showNetworkSetup()">
                <label for="multi_location_yes">Yes</label>
                <input type="radio" id="multi_location_no" name="multi_location" value="no" onclick="hideNetworkSetup()">
                <label for="multi_location_no">No</label>
            </div>
        </div>
        <div id="multi_location_message" style="display:none; color:green;">
            Please add additional locations below to provide each location's shipping information
        </div>
        <div id="network_setup" style="display:none;">
            <div class="radio-group">
                <label>Is your network already set up with RG?</label>
                <div class="radio-buttons">
                    <input type="radio" id="rg_setup_yes" name="rg_setup" value="yes" onclick="showBillingType()">
                    <label for="rg_setup_yes">Yes</label>
                    <input type="radio" id="rg_setup_no" name="rg_setup" value="no" onclick="hideBillingType()">
                    <label for="rg_setup_no">No</label>
                </div>
            </div>
        </div>
        <div id="billing_type" style="display:none;">
            <div class="radio-group">
                <label>Is your billing centralized or localized?</label>
                <div class="radio-buttons">
                    <input type="radio" id="billing_centralized" name="billing" value="centralized" onclick="showCentralizedMessage()">
                    <label for="billing_centralized">Centralized</label>
                    <input type="radio" id="billing_localized" name="billing" value="localized" onclick="showLocalizedMessage()">
                    <label for="billing_localized">Localized</label>
                </div>
            </div>
            <div id="centralized_message" style="display:none; color:green;">
                By selecting this field RG will set up your location as a sub-account and send invoices to your parent company
            </div>
            <div id="localized_message" style="display:none; color:red;">
                In the primary information below please provide information relevant to your specific location
            </div>
        </div>
        <div class="radio-group">
            <label>Are you tax exempt?</label>
            <div class="radio-buttons">
                <input type="radio" id="tax_exempt_yes" name="tax_exempt" value="yes" required>
                <label for="tax_exempt_yes">Yes</label>
                <input type="radio" id="tax_exempt_no" name="tax_exempt" value="no">
                <label for="tax_exempt_no">No</label>
            </div>
        </div>
        <div id="tax_exempt_message" class="tax-exempt-message" style="display:none;">
            Please provide a tax-exemption form to your rep
        </div>
        <div class="radio-group">
            <label>Payment Terms Requested:</label>
            <div class="radio-buttons">
                <input type="radio" id="payment_terms_yes" name="payment_terms" value="yes" required>
                <label for="payment_terms_yes">Yes</label>
                <input type="radio" id="payment_terms_no" name="payment_terms" value="no">
                <label for="payment_terms_no">No</label>
            </div>
        </div>
        <div id="payment_terms_message" class="payment-terms-message" style="display:none;">
            Please provide a credit reference form to your rep
        </div>
        <div id="payment_terms_no_message" style="display:none; color:red;">
            By default customers are set up with Due On Receipt and can pay with check, card, or ACH link prior to or upon delivery
        </div>
        <div class="dropdown-group">
            <label for="rep">Who is the rep?</label>
            <div class="dropdown-field">
                <select id="rep" name="rep" required aria-label="Sales Representative">
                    <option value="">Select a rep</option>
                    <option>Kris</option>
                    <option>Tia</option>
                    <option>Leann</option>
                    <option>Kelly</option>
                    <option>Kelli</option>
                </select>
            </div>
        </div>
        <div class="radio-group">
            <label>Are you a member of a GPO?</label>
            <div class="radio-buttons">
                <input type="radio" id="gpo_yes" name="gpo" value="yes" required onclick="showGpoOptions()">
                <label for="gpo_yes">Yes</label>
                <input type="radio" id="gpo_no" name="gpo" value="no" onclick="hideGpoOptions()">
                <label for="gpo_no">No</label>
            </div>
        </div>
        <div id="gpo_options" style="display:none;">
            <select name="gpo_type" aria-label="GPO Type">
                <option>Premier</option>
                <option>Vizient</option>
                <option>VA</option>
                <option>Forum</option>
                <option>Sodexo</option>
            </select>
        </div>
        <div class="radio-group">
            <label>Will you purchase from a distributor?</label>
            <div class="radio-buttons">
                <input type="radio" id="distributor_yes" name="distributor" value="yes" required onclick="showDistOptions()">
                <label for="distributor_yes">Yes</label>
                <input type="radio" id="distributor_no" name="distributor" value="no" onclick="hideDistOptions()">
                <label for="distributor_no">No</label>
            </div>
        </div>
        <div id="dist_options" style="display:none;">
            <select name="dist_type" aria-label="Distributor Type">
                <option>US Foods</option>
                <option>Sysco</option>
                <option>GFS</option>
                <option>Food Buy</option>
                <option>Performance Food Group</option>
            </select>
            <input type="text" id="dist_location" name="dist_location" maxlength="50" placeholder="Distributor Location Name or Number" aria-label="Distributor Location">
        </div>
        <div class="dropdown-group">
            <label for="pricing">What pricing structure is this customer?</label>
            <div class="dropdown-field">
                <select id="pricing" name="pricing" onchange="checkOther(this)" aria-label="Pricing Structure">
                    <option>Frontline</option>
                    <option>GPO</option>
                    <option>WS</option>
                    <option>Coffee Shop</option>
                    <option>Sussex</option>
                    <option>Sodexo</option>
                    <option>other</option>
                </select>
            </div>
        </div>
        <div id="other_pricing" style="display:none;">
            <input type="text" name="other_pricing" maxlength="20" aria-label="Custom Pricing Structure">
        </div>
        <div id="single_billing" class="radio-group" style="display:none;">
            <label>Do you have a single billing point of contact?</label>
            <div class="radio-buttons">
                <input type="radio" id="single_billing_yes" name="single_billing" value="yes">
                <label for="single_billing_yes">Yes</label>
                <input type="radio" id="single_billing_no" name="single_billing" value="no">
                <label for="single_billing_no">No</label>
            </div>
        </div>
        <div id="single_billing_message" style="display:none; color:green;">
            Please add additional locations below to provide billing and shipping information for each location
        </div>
        <div id="locations">
            <div class="location">
                <h2>Primary Information</h2>
                <div>
                    <label>Purchasing Contact:</label>
                    <div class="row">
                        <input type="text" name="purchasing_first[]" placeholder="First Name" required aria-label="Purchasing Contact First Name">
                        <input type="text" name="purchasing_last[]" placeholder="Last Name" required aria-label="Purchasing Contact Last Name">
                    </div>
                    <div class="row">
                        <input type="email" name="purchasing_email[]" placeholder="Email" pattern="[a-z0-9._%+-]+@[a-z0-9.-]+\.[a-z]{2,}$" required aria-label="Purchasing Contact Email">
                        <input type="tel" name="purchasing_phone[]" placeholder="Phone Number" pattern="[0-9]{10,}" required aria-label="Purchasing Contact Phone">
                    </div>
                </div>
                <div>
                    <label>Billing Address:</label>
                    <div class="row">
                        <input type="text" name="billing_street[]" placeholder="Street" required aria-label="Billing Street">
                        <input type="text" name="billing_city[]" placeholder="City" required aria-label="Billing City">
                        <input type="text" name="billing_state[]" placeholder="State" required aria-label="Billing State">
                        <input type="text" name="billing_zip[]" placeholder="Zip Code" pattern="[0-9]{5}(-[0-9]{4})?" required aria-label="Billing Zip Code">
                    </div>
                </div>
                <div class="accounts-payable">
                    <label>Accounts Payable Contact:</label>
                    <div class="row">
                        <input type="text" name="ap_first[]" placeholder="First Name" aria-label="Accounts Payable First Name">
                        <input type="text" name="ap_last[]" placeholder="Last Name" aria-label="Accounts Payable Last Name">
                    </div>
                    <div class="row">
                        <input type="email" name="ap_email[]" placeholder="Email" pattern="[a-z0-9._%+-]+@[a-z0-9.-]+\.[a-z]{2,}$" aria-label="Accounts Payable Email">
                        <input type="tel" name="ap_phone[]" placeholder="Phone Number" pattern="[0-9]{10,}" aria-label="Accounts Payable Phone">
                    </div>
                </div>
                <div>
                    <label>Ship to Address:</label>
                    <div class="row">
                        <input type="text" name="ship_street[]" placeholder="Street" required aria-label="Shipping Street">
                        <input type="text" name="ship_city[]" placeholder="City" required aria-label="Shipping City">
                        <input type="text" name="ship_state[]" placeholder="State" required aria-label="Shipping State">
                        <input type="text" name="ship_zip[]" placeholder="Zip Code" pattern="[0-9]{5}(-[0-9]{4})?" required aria-label="Shipping Zip Code">
                    </div>
                </div>
                <div>
                    <label>Warehouse and/or Receiving Contact:</label>
                    <div class="row">
                        <input type="text" name="warehouse_first[]" placeholder="First Name" required aria-label="Warehouse Contact First Name">
                        <input type="text" name="warehouse_last[]" placeholder="Last Name" required aria-label="Warehouse Contact Last Name">
                    </div>
                    <div class="row">
                        <input type="email" name="warehouse_email[]" placeholder="Email" pattern="[a-z0-9._%+-]+@[a-z0-9.-]+\.[a-z]{2,}$" required aria-label="Warehouse Contact Email">
                        <input type="tel" name="warehouse_phone[]" placeholder="Phone Number" pattern="[0-9]{10,}" required aria-label="Warehouse Contact Phone">
                    </div>
                </div>
                <div class="dropdown-group">
                    <label for="delivery_hours_0">Dock Availability:</label>
                    <div class="dropdown-field">
                        <input type="text" id="delivery_hours_0" name="delivery_hours[]" placeholder="Hours & Days" required aria-label="Dock Availability">
                    </div>
                </div>
                <div class="radio-group">
                    <label>Liftgate Required?</label>
                    <div class="radio-buttons">
                        <input type="radio" id="liftgate_yes_0" name="liftgate[0]" value="yes" required>
                        <label for="liftgate_yes_0">Yes</label>
                        <input type="radio" id="liftgate_no_0" name="liftgate[0]" value="no">
                        <label for="liftgate_no_0">No</label>
                    </div>
                </div>
                <div class="radio-group">
                    <label>Delivery Appointment Required?</label>
                    <div class="radio-buttons">
                        <input type="radio" id="appt_yes_0" name="appt[0]" value="yes" required>
                        <label for="appt_yes_0">Yes</label>
                        <input type="radio" id="appt_no_0" name="appt[0]" value="no">
                        <label for="appt_no_0">No</label>
                    </div>
                </div>
            </div>
        </div>
        <button type="button" onclick="addLocation()">Add More Locations</button>
        <div>
            <label for="notes">Special Account Notes:</label><br>
            <textarea id="notes" name="notes" maxlength="200" aria-label="Special Account Notes"></textarea>
        </div>
        <div id="signature-section">
            <div class="signature-container">
                <label for="signature-pad">Signature (Required):</label>
                <div id="signature-instructions" style="color: #ccc; font-size: 12px; margin-bottom: 5px;">
                    Use your mouse to draw your signature or type below.
                </div>
                <div id="mobile-signature-instructions" style="color: #ccc; font-size: 12px; margin-bottom: 5px; display: none;">
                    Touch to draw your signature or type below.
                </div>
                <canvas id="signature-pad" width="400" height="150" aria-label="Draw your signature here"></canvas>
                <canvas id="mobile-signature-pad" width="400" height="150" aria-label="Draw your signature here"></canvas>
                <input type="text" id="text-signature" name="text-signature" placeholder="Type your signature" aria-label="Type your signature">
                <input type="hidden" id="signature-data" name="signature" value="">
                <button type="button" id="save-signature">Save Signature</button>
                <button type="button" id="clear-signature">Clear Signature</button>
            </div>
        </div>
        <button type="button" id="save-form">Save</button>
        <button type="button" id="clear-form">Clear</button>
        <button type="submit" id="submit-form" aria-label="Submit Form">Submit Form</button>
    </form>
</body>
</html>
