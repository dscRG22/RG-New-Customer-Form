<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>New Customer Intake Form</title>
    <style>
        body {
            background-color: black;
            display: flex;
            justify-content: center;
            align-items: center;
            min-height: 100vh;
            margin: 0;
            font-family: Arial, sans-serif;
        }
        form {
            background-color: #333;
            padding: 20px;
            max-width: 1000px;
            width: 100%;
            text-align: center;
            box-sizing: border-box;
            color: white;
        }
        .row {
            display: flex;
            gap: 10px;
            margin-bottom: 10px;
            justify-content: center;
            flex-wrap: wrap;
        }
        .row input {
            flex: 1;
            min-width: 150px;
            max-width: 250px;
            padding: 5px;
            color: white;
            background-color: #444;
            border: 1px solid #666;
        }
        #customer_name {
            max-width: 400px;
            width: 100%;
            color: white;
            background-color: #444;
            border: 1px solid #666;
        }
        #notes {
            max-width: 500px;
            width: 100%;
            height: 100px;
            color: white;
            background-color: #444;
            border: 1px solid #666;
        }
        #dist_location {
            color: white;
            background-color: #444;
            border: 1px solid #666;
        }
        input[name^="delivery_hours"] {
            color: white;
            background-color: #444;
            border: 1px solid #666;
            width: 250px;
        }
        input[name="other_pricing"] {
            color: white;
            background-color: #444;
            border: 1px solid #666;
            max-width: 250px;
        }
        div {
            margin-bottom: 15px;
        }
        label, input, select, textarea {
            display: inline-block;
            text-align: center;
            color: white;
        }
        select {
            background-color: #444;
            border: 1px solid #666;
        }
        button {
            margin: 15px auto;
            padding: 10px 20px;
            background-color: #444;
            border: 1px solid #666;
            border-radius: 5px;
            cursor: pointer;
            color: white;
        }
        button:hover {
            background-color: #555;
        }
        #locations {
            text-align: center;
        }
        .location {
            margin-bottom: 20px;
        }
        #gpo_options, #dist_options, #other_pricing {
            text-align: center;
        }
        #signature-pad {
            border: 1px solid #666;
            background-color: #222;
            width: 500px;
            height: 150px;
            display: block;
        }
        #signature-section {
            margin-top: 20px;
        }
        .signature-container {
            display: flex;
            flex-direction: column;
            align-items: center;
        }
        .radio-group {
            display: flex;
            align-items: center;
            justify-content: center;
            gap: 10px;
        }
        .radio-buttons {
            display: flex;
            gap: 5px;
            margin-left: 10px;
        }
        .radio-buttons input {
            margin-right: 5px;
        }
        .dropdown-group {
            display: flex;
            align-items: center;
            justify-content: center;
            gap: 10px;
        }
        .dropdown-field {
            display: flex;
            gap: 5px;
            margin-left: 10px;
        }
        .w9-message {
            font-weight: bold;
            color: white;
            margin-top: 5px;
            font-size: 16px;
        }

        .logo-container {
            margin-bottom: 10px;
            text-align: center;
            padding: 10px;
        }
        .logo-container img {
            width: 100px;
            height: auto;
            display: block;
            margin: 0 auto;
        }
    </style>
    <script>
        function addLocation() {
            var locations = document.getElementById('locations');
            if (!locations.getElementsByClassName('location')[0]) return;
            var count = locations.getElementsByClassName('location').length;
            var newLoc = locations.getElementsByClassName('location')[0].cloneNode(true);
            
            // Update header and add remove button
            newLoc.querySelector('h2').textContent = 'Location ' + count + ' Information';
            var removeBtn = document.createElement('button');
            removeBtn.type = 'button';
            removeBtn.textContent = 'Remove Location';
            removeBtn.onclick = function() { removeLocation(this); };
            newLoc.appendChild(removeBtn);
            
            // Update input names, clear values, ensure correct label/placeholder, and set required
            var inputs = newLoc.querySelectorAll('input');
            for (var i = 0; i < inputs.length; i++) {
                if (inputs[i].name) {
                    inputs[i].name = inputs[i].name.replace(/\[\d+\]/, '[' + count + ']');
                    inputs[i].value = '';
                    if (inputs[i].type === 'radio') {
                        inputs[i].checked = false;
                    }
                    if (inputs[i].name.startsWith('delivery_hours')) {
                        inputs[i].id = 'delivery_hours[' + count + ']';
                        inputs[i].setAttribute('aria-label', 'Dock Availability');
                        inputs[i].placeholder = 'Hours & Days';
                    }
                    // Ensure required fields in cloned locations
                    if (inputs[i].name.match(/^(warehouse|ap)_(first|last|email|phone)\[\d+\]$/)) {
                        inputs[i].setAttribute('required', 'required');
                    }
                }
            }
            // Update label for Dock Availability
            var label = newLoc.querySelector('label[for^="delivery_hours"]');
            if (label) {
                label.textContent = 'Dock Availability:';
                label.setAttribute('for', 'delivery_hours[' + count + ']');
            }
            
            locations.appendChild(newLoc);
        }

        function removeLocation(button) {
            var locations = document.getElementById('locations');
            if (locations.getElementsByClassName('location').length > 1) {
                button.parentElement.remove();
                updateLocationHeaders();
            }
        }

        function updateLocationHeaders() {
            var locations = document.getElementById('locations').getElementsByClassName('location');
            for (var i = 0; i < locations.length; i++) {
                locations[i].querySelector('h2').textContent = 'Location ' + (i === 0 ? 'Primary' : i) + ' Information';
                var inputs = locations[i].querySelectorAll('input');
                for (var j = 0; j < inputs.length; j++) {
                    if (inputs[j].name) {
                        inputs[j].name = inputs[j].name.replace(/\[\d+\]/, '[' + i + ']');
                    }
                    if (inputs[j].name.startsWith('delivery_hours')) {
                        inputs[j].id = 'delivery_hours[' + i + ']';
                        inputs[j].setAttribute('aria-label', 'Dock Availability');
                        inputs[j].placeholder = 'Hours & Days';
                    }
                    // Ensure required fields in updated locations
                    if (inputs[j].name.match(/^(warehouse|ap)_(first|last|email|phone)\[\d+\]$/)) {
                        inputs[j].setAttribute('required', 'required');
                    }
                }
                var label = locations[i].querySelector('label[for^="delivery_hours"]');
                if (label) {
                    label.setAttribute('for', 'delivery_hours[' + i + ']');
                    label.textContent = 'Dock Availability:';
                }
            }
        }

        function showGpoOptions() {
            document.getElementById('gpo_options').style.display = 'block';
        }

        function hideGpoOptions() {
            document.getElementById('gpo_options').style.display = 'none';
        }

        function showDistOptions() {
            document.getElementById('dist_options').style.display = 'block';
        }

        function hideDistOptions() {
            document.getElementById('dist_options').style.display = 'none';
        }

        function checkOther(select) {
            if (select.value === 'other') {
                document.getElementById('other_pricing').style.display = 'block';
            } else {
                document.getElementById('other_pricing').style.display = 'none';
            }
        }

        // Signature Pad JavaScript
        window.onload = function() {
            const canvas = document.getElementById('signature-pad');
            const ctx = canvas.getContext('2d');
            ctx.strokeStyle = '#ffffff';
            ctx.lineWidth = 2;
            let isDrawing = false;
            let lastX = 0;
            let lastY = 0;

            canvas.addEventListener('mousedown', (e) => {
                isDrawing = true;
                [lastX, lastY] = [e.offsetX, e.offsetY];
            });

            canvas.addEventListener('mousemove', (e) => {
                if (isDrawing) {
                    ctx.beginPath();
                    ctx.moveTo(lastX, lastY);
                    ctx.lineTo(e.offsetX, e.offsetY);
                    ctx.stroke();
                    [lastX, lastY] = [e.offsetX, e.offsetY];
                }
            });

            canvas.addEventListener('mouseup', () => isDrawing = false);
            canvas.addEventListener('mouseout', () => isDrawing = false);

            // Touch support for mobile devices
            canvas.addEventListener('touchstart', (e) => {
                e.preventDefault();
                const touch = e.touches[0];
                const rect = canvas.getBoundingClientRect();
                isDrawing = true;
                [lastX, lastY] = [touch.clientX - rect.left, touch.clientY - rect.top];
            });

            canvas.addEventListener('touchmove', (e) => {
                e.preventDefault();
                if (isDrawing) {
                    const touch = e.touches[0];
                    const rect = canvas.getBoundingClientRect();
                    const x = touch.clientX - rect.left;
                    const y = touch.clientY - rect.top;
                    ctx.beginPath();
                    ctx.moveTo(lastX, lastY);
                    ctx.lineTo(x, y);
                    ctx.stroke();
                    [lastX, lastY] = [x, y];
                }
            });

            canvas.addEventListener('touchend', () => isDrawing = false);

            // Clear signature
            document.getElementById('clear-signature').addEventListener('click', () => {
                ctx.clearRect(0, 0, canvas.width, canvas.height);
                document.getElementById('signature-data').value = '';
            });

            // Update hidden input with base64 signature data on form submit
            document.querySelector('form').addEventListener('submit', (e) => {
                const imageData = ctx.getImageData(0, 0, canvas.width, canvas.height).data;
                const isCanvasEmpty = imageData.every(val => val === 0);
                if (isCanvasEmpty) {
                    e.preventDefault();
                    alert('Please provide a signature.');
                    return;
                }
                const signatureData = canvas.toDataURL('image/png');
                document.getElementById('signature-data').value = signatureData;
            });

            // Tax exempt message toggle
            document.getElementById('tax_exempt_yes').addEventListener('change', () => {
                document.getElementById('tax_exempt_message').style.display = 'block';
            });
            document.getElementById('tax_exempt_no').addEventListener('change', () => {
                document.getElementById('tax_exempt_message').style.display = 'none';
            });

            // Payment terms message toggle
            document.getElementById('payment_terms_yes').addEventListener('change', () => {
                document.getElementById('payment_terms_message').style.display = 'block';
                document.getElementById('payment_terms_no_message').style.display = 'none';
            });
            document.getElementById('payment_terms_no').addEventListener('change', () => {
                document.getElementById('payment_terms_message').style.display = 'none';
                document.getElementById('payment_terms_no_message').style.display = 'block';
            });
        };
    </script>
</head>
<body>
    <form name="customer-intake" method="POST" data-netlify="true" netlify-honeypot="bot-field">
        <input type="hidden" name="form-name" value="customer-intake">
        <p hidden><label>Don't fill this out: <input name="bot-field"></label></p>
           <div class="logo-container">
        <img src="your-logo-file.png" alt="Company Logo">
    </div>
        <h1>New Customer Intake Form</h1>

        <div>
            <label for="customer_name">Customer Name:</label><br>
            <input type="text" id="customer_name" name="customer_name" required aria-label="Customer Name">
            <br>
            <h6 class="w9-message">Please provide an up to date W-9</h6>
        </div>

        <div class="radio-group">
            <label>Are you tax exempt?</label>
            <div class="radio-buttons">
                <input type="radio" id="tax_exempt_yes" name="tax_exempt" value="yes" required> 
                <label for="tax_exempt_yes">Yes</label>
                <input type="radio" id="tax_exempt_no" name="tax_exempt" value="no"> 
                <label for="tax_exempt_no">No</label>
            </div>
        </div>
        <div id="tax_exempt_message" style="display:none; color:red;">
            Please provide a tax-exemption form to your rep
        </div>

        <div class="radio-group">
            <label>Payment Terms Requested:</label>
            <div class="radio-buttons">
                <input type="radio" id="payment_terms_yes" name="payment_terms" value="yes" required> 
                <label for="payment_terms_yes">Yes</label>
                <input type="radio" id="payment_terms_no" name="payment_terms" value="no"> 
                <label for="payment_terms_no">No</label>
            </div>
        </div>
        <div id="payment_terms_message" style="display:none; color:red;">
            Please provide a credit reference form to your rep
        </div>
        <div id="payment_terms_no_message" style="display:none; color:red;">
            By default customers are set up with Due On Receipt and can pay with check, card, or ACH link prior to or upon delivery
        </div>

        <div class="dropdown-group">
            <label for="rep">Who is the rep?</label>
            <div class="dropdown-field">
                <select id="rep" name="rep" required aria-label="Sales Representative">
                    <option value="">Select a rep</option>
                    <option>Kris</option>
                    <option>Tia</option>
                    <option>Leann</option>
                    <option>Kelly</option>
                    <option>Kelli</option>
                </select>
            </div>
        </div>

        <div class="radio-group">
            <label>Are you a member of a GPO?</label>
            <div class="radio-buttons">
                <input type="radio" id="gpo_yes" name="gpo" value="yes" required onclick="showGpoOptions()"> 
                <label for="gpo_yes">Yes</label>
                <input type="radio" id="gpo_no" name="gpo" value="no" onclick="hideGpoOptions()"> 
                <label for="gpo_no">No</label>
            </div>
        </div>
        <div id="gpo_options" style="display:none;">
            <select name="gpo_type" aria-label="GPO Type">
                <option>Premier</option>
                <option>Vizient</option>
                <option>VA</option>
                <option>Forum</option>
                <option>Sodexo</option>
            </select>
        </div>

        <div class="radio-group">
            <label>Will you purchase from a distributor?</label>
            <div class="radio-buttons">
                <input type="radio" id="distributor_yes" name="distributor" value="yes" required onclick="showDistOptions()"> 
                <label for="distributor_yes">Yes</label>
                <input type="radio" id="distributor_no" name="distributor" value="no" onclick="hideDistOptions()"> 
                <label for="distributor_no">No</label>
            </div>
        </div>
        <div id="dist_options" style="display:none;">
            <select name="dist_type" aria-label="Distributor Type">
                <option>US Foods</option>
                <option>Sysco</option>
                <option>GFS</option>
                <option>Food Buy</option>
                <option>Performance Food Group</option>
            </select>
            <input type="text" id="dist_location" name="dist_location" maxlength="50" placeholder="Distributor Location Name or Number" aria-label="Distributor Location">
        </div>

        <div class="dropdown-group">
            <label for="pricing">What pricing structure is this customer?</label>
            <div class="dropdown-field">
                <select id="pricing" name="pricing" onchange="checkOther(this)" aria-label="Pricing Structure">
                    <option>Frontline</option>
                    <option>GPO</option>
                    <option>WS</option>
                    <option>Coffee Shop</option>
                    <option>Sussex</option>
                    <option>Sodexo</option>
                    <option>other</option>
                </select>
            </div>
        </div>
        <div id="other_pricing" style="display:none;">
            <input type="text" name="other_pricing" maxlength="20" aria-label="Custom Pricing Structure">
        </div>

        <div class="radio-group">
            <label>Do you have a single billing point of contact?</label>
            <div class="radio-buttons">
                <input type="radio" id="single_billing_yes" name="single_billing" value="yes" required> 
                <label for="single_billing_yes">Yes</label>
                <input type="radio" id="single_billing_no" name="single_billing" value="no"> 
                <label for="single_billing_no">No</label>
            </div>
        </div>

        <div class="radio-group">
            <label>Do you have a single delivery address?</label>
            <div class="radio-buttons">
                <input type="radio" id="single_delivery_yes" name="single_delivery" value="yes" required> 
                <label for="single_delivery_yes">Yes</label>
                <input type="radio" id="single_delivery_no" name="single_delivery" value="no"> 
                <label for="single_delivery_no">No</label>
            </div>
        </div>

        <div id="locations">
            <div class="location">
                <h2>Primary Information</h2>
                <div>
                    <label>Purchasing Contact:</label>
                    <div class="row">
                        <input type="text" name="purchasing_first[0]" placeholder="First Name" required aria-label="Purchasing Contact First Name">
                        <input type="text" name="purchasing_last[0]" placeholder="Last Name" required aria-label="Purchasing Contact Last Name">
                    </div>
                    <div class="row">
                        <input type="email" name="purchasing_email[0]" placeholder="Email" pattern="[a-z0-9._%+-]+@[a-z0-9.-]+\.[a-z]{2,}$" required aria-label="Purchasing Contact Email">
                        <input type="tel" name="purchasing_phone[0]" placeholder="Phone Number" pattern="[0-9]{10,}" required aria-label="Purchasing Contact Phone">
                    </div>
                </div>

                <div>
                    <label>Billing Address:</label>
                    <div class="row">
                        <input type="text" name="billing_street[0]" placeholder="Street" required aria-label="Billing Street">
                        <input type="text" name="billing_city[0]" placeholder="City" required aria-label="Billing City">
                        <input type="text" name="billing_state[0]" placeholder="State" required aria-label="Billing State">
                        <input type="text" name="billing_zip[0]" placeholder="Zip Code" pattern="[0-9]{5}(-[0-9]{4})?" required aria-label="Billing Zip Code">
                    </div>
                </div>

                <div>
                    <label>Accounts Payable Contact:</label>
                    <div class="row">
                        <input type="text" name="ap_first[0]" placeholder="First Name" required aria-label="Accounts Payable First Name">
                        <input type="text" name="ap_last[0]" placeholder="Last Name" required aria-label="Accounts Payable Last Name">
                    </div>
                    <div class="row">
                        <input type="email" name="ap_email[0]" placeholder="Email" pattern="[a-z0-9._%+-]+@[a-z0-9.-]+\.[a-z]{2,}$" required aria-label="Accounts Payable Email">
                        <input type="tel" name="ap_phone[0]" placeholder="Phone Number" pattern="[0-9]{10,}" required aria-label="Accounts Payable Phone">
                    </div>
                </div>

                <div>
                    <label>Ship to Address:</label>
                    <div class="row">
                        <input type="text" name="ship_street[0]" placeholder="Street" required aria-label="Shipping Street">
                        <input type="text" name="ship_city[0]" placeholder="City" required aria-label="Shipping City">
                        <input type="text" name="ship_state[0]" placeholder="State" required aria-label="Shipping State">
                        <input type="text" name="ship_zip[0]" placeholder="Zip Code" pattern="[0-9]{5}(-[0-9]{4})?" required aria-label="Shipping Zip Code">
                    </div>
                </div>

                <div>
                    <label>Warehouse and/or Receiving Contact:</label>
                    <div class="row">
                        <input type="text" name="warehouse_first[0]" placeholder="First Name" required aria-label="Warehouse Contact First Name">
                        <input type="text" name="warehouse_last[0]" placeholder="Last Name" required aria-label="Warehouse Contact Last Name">
                    </div>
                    <div class="row">
                        <input type="email" name="warehouse_email[0]" placeholder="Email" pattern="[a-z0-9._%+-]+@[a-z0-9.-]+\.[a-z]{2,}$" required aria-label="Warehouse Contact Email">
                        <input type="tel" name="warehouse_phone[0]" placeholder="Phone Number" pattern="[0-9]{10,}" required aria-label="Warehouse Contact Phone">
                    </div>
                </div>

                <div class="dropdown-group">
                    <label for="delivery_hours[0]">Dock Availability:</label>
                    <div class="dropdown-field">
                        <input type="text" id="delivery_hours[0]" name="delivery_hours[0]" placeholder="Hours & Days" aria-label="Dock Availability">
                    </div>
                </div>

                <div class="radio-group">
                    <label>Liftgate Required?</label>
                    <div class="radio-buttons">
                        <input type="radio" id="liftgate_yes[0]" name="liftgate[0]" value="yes"> 
                        <label for="liftgate_yes[0]">Yes</label>
                        <input type="radio" id="liftgate_no[0]" name="liftgate[0]" value="no"> 
                        <label for="liftgate_no[0]">No</label>
                    </div>
                </div>

                <div class="radio-group">
                    <label>Delivery Appointment Required?</label>
                    <div class="radio-buttons">
                        <input type="radio" id="appt_yes[0]" name="appt[0]" value="yes"> 
                        <label for="appt_yes[0]">Yes</label>
                        <input type="radio" id="appt_no[0]" name="appt[0]" value="no"> 
                        <label for="appt_no[0]">No</label>
                    </div>
                </div>
            </div>
        </div>

        <button type="button" onclick="addLocation()">Add More Locations</button>

        <div>
            <label for="notes">Special Account Notes:</label><br>
            <textarea id="notes" name="notes" maxlength="200" aria-label="Special Account Notes"></textarea>
        </div>

        <div id="signature-section">
            <div class="signature-container">
                <label for="signature-pad">Signature (Required):</label>
                <canvas id="signature-pad" width="500" height="150" aria-label="Signature Pad"></canvas>
                <input type="hidden" id="signature-data" name="signature" value="">
                <button type="button" id="clear-signature">Clear Signature</button>
            </div>
        </div>

        <button type="submit">Submit Form</button>
    </form>
</body>
</html>
